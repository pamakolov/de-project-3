1. Добавил все sql-скрипты в отдельную папку



2. В mart.f_customer_retention добавил временную таблицу с удалением дат, чтоб все работало автоматически в даге



3. В mart.f_customer_retention добавил кусок с удалением дат, которые мы перезаписываем в случае повторного запуска дага



4. А вот для таблицы staging.user_order_log у меня затык. Там тоже надо добавить удаление даты, чтоб не было дублирования.
Но внутри py-файла в функции upload_data_to_staging я хотел добавить вот этот кусок

sql = text(f"""delete from staging.user_order_log where date_time in ({date})""")
engine.execute(sql),

где date - то, что передаем в функцию в кач-ве аргумента и код валится, не понимаю в чем ошибка.


какой есть еще способ, чтоб красиво и быстро прописать этот delete ?
 

